# 🔧 快捷键调试说明

## 问题分析
快捷键Ctrl+S没有生效，可能的原因：
1. 事件监听器没有正确绑定
2. DOM查找方式有问题（原来的实现）
3. 组件间通信问题

## 解决方案
改用自定义事件方式实现组件间通信：

### 1. App.jsx - 快捷键监听
```javascript
// Ctrl + S 导出图片
if (event.ctrlKey && event.key === 's') {
  event.preventDefault();
  console.log('Ctrl+S pressed, chartData:', !!appState.chartData);
  
  // 发送自定义事件
  if (appState.chartData) {
    console.log('Dispatching export-shortcut event');
    window.dispatchEvent(new CustomEvent('export-shortcut', { 
      detail: { format: 'jpeg' } 
    }));
  } else {
    alert('请先生成尺码表数据');
  }
}
```

### 2. PreviewPanel.jsx - 事件响应
```javascript
// 监听快捷键导出事件
useEffect(() => {
  const handleExportShortcut = (event) => {
    console.log('Export shortcut event received:', event.detail);
    const { format } = event.detail;
    handleExportImage(format);
  };

  window.addEventListener('export-shortcut', handleExportShortcut);
  return () => window.removeEventListener('export-shortcut', handleExportShortcut);
}, [chartData, appState.exportPath]);
```

## 测试步骤

### 准备工作
1. 打开应用程序
2. 选择至少一个尺码类别（如胸围、袖长等）
3. 配置尺码设置
4. 点击"应用设置"生成尺码表数据

### 快捷键测试
1. **按Ctrl+S**
2. **观察控制台输出**：
   - 应该看到："Ctrl+S pressed, chartData: true"
   - 应该看到："Dispatching export-shortcut event"  
   - 应该看到："Export shortcut event received: {format: 'jpeg'}"

### 预期结果
- 如果设置了导出路径：图片直接保存到指定文件夹
- 如果未设置路径：弹出保存对话框
- 控制台显示完整的事件流程

## 故障排除

### 如果控制台没有输出
- 检查是否在正确的窗口中按快捷键
- 确认焦点在应用程序窗口中
- 尝试刷新页面

### 如果有"No chart data available"提示
- 确认已选择尺码类别
- 确认已点击"应用设置"按钮
- 检查预览面板是否显示尺码表

### 如果事件发送但没有响应
- 检查PreviewPanel组件是否正确渲染
- 确认事件监听器正确绑定

## 调试命令
在浏览器控制台中手动测试：
```javascript
// 手动触发导出事件
window.dispatchEvent(new CustomEvent('export-shortcut', { 
  detail: { format: 'jpeg' } 
}));
```
